
# 🐳도커를 공부하기 전에...🐳

최근 도커/쿠버네티스와 같은 운영환경이 개발에 주를 이루고 있다. 이에 먼저 컨테이너를 쉽게 이식하고 운영 환경에 굉장히 용이한 도커를 학습하고싶었다. 이에 본 글은 [도커/쿠버네티스를 활용한 컨테이너 개발 실전 입문](http://www.yes24.com/Product/Goods/70893433)을 읽고 대략 총 20개의 글로 나누어 도커에 대해 작성할 예정이다.

책을 요약하여 이루고자 하는 목표는 도커를 이해하고 기본적인 입문 단계에 이루어 실제 개발에 사용하고자하는 목표이다. 물론 빠르게 quick start하는 방법으로는 다른 [좋은 블로그](https://subicura.com/2017/01/19/docker-guide-for-beginners-1.html) 글들이 많다. 그러나 나는 무조건 빠르게 시작하는 것보다 정확하게 이해하고 학습하는 것을 중요시 여긴다. 이에 따로 책 한권을 선정하여 공부하기로 결심하였고, 그렇다고 책 한권을 질질 끌 생각은 없다. 해당 책을 완독하는데 생각하는 기간은 10일 미만이다. 고로 빠르게 책을 학습해나가는 대신에, 본문 글의 중요한 내용(~~사실 다 중요하다..~~)을 요약하고 한다. 이에 도커에 대한 내용을 빠르게 학습하고 이후 쿠버네티스에 대한 글을 요약하도록 하겠다. 더 자세한 내용은 부디 [책](http://www.yes24.com/Product/Goods/70893433)을 참고하길 부탁드립니다.


<br><br>

# 🐳 01.도커의 기초 - 도커란 무엇인가? 🐳

사실 우리는 어떠한 기술을 사용하기 전에 이 기술을 **왜?** 사용해야하는지 알아야한다. 그렇기에 항상 기술의 등장 배경과 개념은 가장 중요한 챕터이다. 해당 챕터는 가장 중요한 시작이기에 가급적 책의 본문이에 모두 도커란 무엇인지 살펴보도록 하자.

<br><br>

## 도커란 무엇인가

도커(Docker)는 컨테이너형 가상화 기술을 구현하기 위한 상주 애플리케이션과 이 애플리케이션을 조작하기 위한 명령형 도구로 구성되는 프로덕트이다. 애플리케이션 배포에 특화돼 있기 때문에 애플리케이션 개발 및 운영을 컨테이너 중심으로 할 수 있다.

이 말을 조금 더 쉽게 이해시키기 위해 "애플리케이션 테스트에 사용할 경량 가상 환경"을 예를 들겠다.

예를 들어, 웹 애플리케이션을 개발하기 위해 Apache나 Nginx 등의 웹 서버를 구축해야 한다고 가정해보자. 이를 위해서 우리는 평소에 정해진 웹 서버를 똑같이 다운로드 하는 과정을 반복적으로 거쳐야 한다. 그러나 이러한 기존 방법과 달리 도커를 활용하면 보다 편리하게 테스트 환경을 구축할 수 있다. 로컬에 도커만 설치되어있다면, 몇 줄짜리 도커 파일과 명령어 한 줄로 애플리케이션이나 미들웨어가 이미 갖춰진 테스트용 가상환경(도커 컨테이너)을 빠르게 구축할 수 있다.

도커는 기존 가상화 소프트웨어보다 더 가볍게 동작한다. 그러므로 **테스트 환경** 뿐만 아니라 **운영 환경** 에서도 컨테이너를 사용할 수 있다.

또한 도커는 이식성이 뛰어나다. 로컬 머신의 도커 환경에서 실행되던 컨테이너를 다른 서버에 있는 도커 환경에 배포하거나 반대로 다른 환겨엥서 동작하던 컨테이너를 로컬로 가져올 수 있다. 즉, **개발 환경과 운영 환경을 거의 동등하게 재현할 수 있다.**

이 외에도 컨테이너 간의 연동이나 클라우드 플랫폼 지원 등 여러 면에서 장점이 있다.

도커는 시스템 개발 및 운영 환경에서 사용하는 것이 일반적이지만, 그 외에도 다양한 방법으로 활용할 수 있다. 이에 대한 방법은 추후에 배울 것이다.

- 설치가 번거로운 명령형 도구를 도커 컨테이너로 가져다 사용함으로써 호스트를 일정하게 유지하면서도 바로 실행할 수 있음

- 다양한 의존 라이브러리나 도구를도커 컨테이너에 포함시켜 배포함으로써 실행 환경과 상관없이 스크립트의 동적 재현성을 높임.

- 도커 컨테이너를 HTTP 부하테스트의 워커(worker)로 사용해 HTTP 요청 수를 증가 시킨다.

<br><br>

## 도커가 적합하지 않은 경우

물론 도커가 만능해결사는 아니다. 컨테이너는 운영 체제의 동작을 완전히 재현하지는 못한다. 이에 좀 더 엄밀한 리눅스 계열 운영 체제의 동작이 요구되는 가상 환경을 구축해야 한다면 기존 방법대로 VMWare나 VirtualBox 같은 가상화 소프트웨어를 사용하는 것이 낫다.

또한 FreeBSD 같은 비리눅스 환경이 필요한 경우에도 도커가 적합하지 않다. 도커는 애초에 가상화 소프트웨어와는 지향하는 바가 다르며, 이들과 경쟁하기 위한 제품도 아니기 때문이다. 다만 애플리케이션을 배포하는 목적에 특화된 박스라고 생각하는 편이 좋다.

<br><br>

## 도커의 역사

2013년 봄 닷클라우드(dotCloud, 현재는 Docker)사의 엔지니어였던 솔로몬 하익스(Solomon Hykes)가 최초로 도커를 오픈 소스로 공개했다. 이에 도커는 점차 널리 퍼져 나가며 현재는 컨테이너 관련 기술의 사실상 표준 지위를 차지하고 있다. 그 뒤로 크로스 플랫폼 지원을 확대하고 엔터프라이즈용 지원을 보강하면서 기업과 개인 등 다양한 계층으로 사용층을 넓히고 있다.

도커와 관련된 오픈 소스 제품 개발 경쟁도 치열하다. 컨테이너 오케스트레이션 도구 분야에서는 도커 사가개발을 주도하는 **도커 스윔(DockerSwarm)** 외에도 현재 이분야에서 한발 앞서 있다는 평가를 받는 **쿠버네티스(Kubernets)**, 아파치 메소스(Apache Mesos) 등이 있다.

<br><br>

## 도커의 기본 개념

### 컨테이너형 가상화 기술

도커는 **컨테이너형 가상화 기술** 을 사용한다.

컨테이너형 가상화 자체는 도커 이전에도 존재하던 기술이다. 도커가 등장하기 전에는 LXC(Linux Containers)가 유명했는데, 도커도 초기에는 컨테이너형 가상화를 구현하는데 LXC를 런타임(현재는 runC)으로 사용했다. 컨테이너형 가상화를 사용하면 가상화 소프트웨어 없이도 운영 체제의 리소스를 격리해 가상 운영 체제를 만들 수 있다. 이 가상 운영 체제를 **컨테이너**라고 한다.

이와 달리, 운영 체제 위에서 가상화 소프트웨어를 사용해 하드웨어를 에뮬레이션하는 방법으로 게스트 운영 체제를 만드는 방식을 호스트 운영 체제 가상화(ex. VMWare..)라고 한다. 컨테이너형 가상화와 비교하면 구조적으로 오버헤드가 더 크다.

<img src = "https://subicura.com/assets/article_images/2017-01-19-docker-guide-for-beginners-1/vm-vs-docker.png">

### 애플리케이션이 중심이 되는 도커

LXC(Linux Containers)는 호스트 운영 체제 가상화보다 성능 면에서 유리하다는 장점으로 시스템 컨테이너로서 어느 정도 자리를 잡았다. 그러나 다른 LXC 호스트에서 실행했을 떄 LXC 설정의 차이로 인해 기대했던 대로 애플리케이션이 동작하지 않는 등의 문제가 있었다.

반면 도커는 컨테이너가 갖는 성능적인 이점을 잘 살리면서도 애플리케이션 배포에 초점을 맞췄다.

**Docker와 LXC의 차이점**

- 호스트 운영 체제의 영향을 받지 않는 실행 환경(Docker Engine을 이용한 실행 환경 표준화)

- DSL(Dockerfile)을 이용한 컨테이너 구성 및 애플리케이션 배포 정의

- 이미지 버전 관리

- 레이어 구조를 갖는 이미지 포맷(차분 빌드가 가능함)

- 도커 레지스트리(이미지 저장 서버 역할을 함)

- 프로그램 가능한 다양한 기능의 API

결론적으로 보면 **도커는 환경의 영향을 덜 받고 배포가 간단하다.**

<br><br><br>

**참고**

[도커/쿠버네티스를 활용한 컨테이너 개발 실전 입문](http://www.yes24.com/Product/Goods/70893433)

[초보를 위한 도커 안내서](https://subicura.com/2017/01/19/docker-guide-for-beginners-1.html)
