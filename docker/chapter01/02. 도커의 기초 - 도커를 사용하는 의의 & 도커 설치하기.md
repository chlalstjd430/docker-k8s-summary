

# 🐳 02.도커의 기초 - 도커를 사용하는 의의 🐳 #

[앞 장](http://blog.cmstown.com/2020/09/docker_01/) 에서 도카가 무엇인지 살펴보았다. 또한 사실 앞장만 봐도 왜 도커를 사용하는지 알 수 있을 것이다. 그럼에도 불구하고 이번장에서 도커를 왜 사용하는지 도커를 사용하는 의의와 도커를 설치하는 방법에 대해 알아보자.

도커를 사용하는 의의는 크게 다음과 같다.

- 변화하지 않는 실행 환경으로 멱등성(Idempotency) 확보

- 코드를 통한 실행 환경 구축 및 애플리케이션 구성

- 실행 환경과 애플리케이션의 일체화로 이식성 향상

- 시스템을 구성하는 애플리케이션 및 미들웨어의 관리 용이성

그럼 위 내용의 장점들을 하나씬 순서대로 살펴보자.


## 환경 차이로 인한 문제 방지

애플리케이션을 개발을 수행하면서 다음과 같은 문제를 경험한 적이 있을 것이다.

> 문제 1 : B 서버에서도 같은 애플리케이션을 배포하고 싶은데, A 서버와 다르게 동작하네ㅐ...
>
> 문제 2 : B 서버에 설치된 라이브러리 버전이 다르네..?
>
> 문제 3 : 모든 서버에 같은 아카이브를 배포하고 싶은데...

위 문제의 근본적인 원인은 **인프라의 가변성(mutable infrastructure)** 을 허용하고 있다는 것이다. 이 문제를 해결하기 위해 최근 제안된 것이 **코드로 관리하는 인프라**와 **불면 인프라** 개념이다. 도커는 도커 이미지(Dockerfile)로 서버 구성을 코드로 관리할 수 있따. 그러므로 기존 컨테이너를 빠르게 폐기하고 새로이 구축할 수 있다. **즉, 도커를 사용하면 코드로 관리하는 인프라와 불변 인프라의 두 개념을 간단하고 낮은 비용으로 실현할 수 있다.**

## 애플리케이션 구성 관리의 용이성

도커 컨테이너는 애플리케이션과 인프라를 함께 담은 상자다. 이 상자를 여러 개 조합하여 시스템을 구성할 수 있어야 한다. 이를 위해 시스템 전체에 대한 적절한 구성 관리가 필요해졌다.

이런 문제는 도커에서 이미 해결했다. 여러 컨테이너를 사용하는 애플리케이션을 쉽게 관리할 수 있도록 **도커 컴포즈(Docker Compose)** 라는 도구를 제공한다. 도커 컴포즈를 사용하면 yaml 포맷으로 작성된 설정 파일로 컨테이너를 정의하거나 컨테이너 간의 의존 관게를 정의해 시작 순서를 제어할 수 있어야 한다.

<br>

도커 컴포즈를 이용하여 Redis 컨테이너 구성에 대한 정의를 하는 예

~~~yaml
version: "3"
services:
    web:
        image: gihyodocker/web
        ports:
            - "3000:3000"
        environemnt:
            REDIS_TARGET: redis
        depends_on:
            - redis
    redis:
        image: "redis:alpine"
~~~

대규모 트래픽 처리 같은 많은 작업을 해야 하는 시스템은 도커가 설치된 서버(도커 노드)를 여러 대 갖추고 이 노드 그룹에 필요한 만큼의 애플리케이션 컨테이너를 배포해야 한다. 도커 컴포즈가 단일 서버를 넘어 여러 서버에 걸쳐 있는 여러 컨테이너를 관리할 수 있도록 한 도구가 **도커 스웜(Docker Swarm)** 이다.

여러 컨테이너를 관리하는 것만이 목적인 도커 컴포즈와 달리 도커 스웜은 컨테이너의 증감은 물론이고 노드의 리소스를 효율적으로 활용하기 위한 컨테이너 배치 및 로드 밸런싱 기능 등 더욱 실용적인 기능을 갖추고 있다. 또, 배포 시에도 롤링 업데이트(오래된 컨테이너와 새로운 컨테이너를 단계적으로 서비스에 교체 투입하는 것)가 가능해 운영 면에서도 장점이 많다. 이렇게 여러 서버에 걸쳐 있는 여러 컨테이너를 관리하는 기법을 **컨테이너 오케스트레이션(container orchestration)** 이라고 한다.

컨테이너 오케스트레이션 분야에서 사실상 표준으로 자리 잡은 것은 **쿠버네티스(Kubernetes)** 다. 쿠버네티스는 구글이 오랫동안 컨테이너를 운영하면서 얻은 노하우를 담은 오픈 소스이고 도커 스웜보다 기능이 충실하며 확정성이 높다. 이에 대해서는 추후에 자세히 다루도록 하겠다.

## 운영 환경에서 빛을 발하는 도커

도커는 실제 개발 환경 뿐만 아니라 운영 환경에서도 많이 사용된다. 도커에는 운영에 도움을 주기 위한 여러도구가 있는데, 임미 주요 클라우드 플랫폼(GCP, AWS 등)에 컨테이너 운영 환경이 갖춰져 있어 도커를 운영 환경에 적용하기 위한 진입 장벽이 많이 낮아져있다.

## 새로운 개발 스타일

도커를 통해 인프라와 애플리케이션이 모두 컨테이너 형태로 제공되면서 인프라와 애플리케이션의 설정을 모두 코드 수준에서 쉽게 수정할 수 있게 됐다. 즉, 기존에는 명확했던 인프라 엔지니어와 서버 사이드 엔지니어의 영역 구분이 점점 희미해지고 있다.

또한 도커는 서버 사이드 엔지니어와 인프라 엔지니어만의 전유물이 아니고 프론트엔드 및 모바일 개발에도 점차 기초 기술이 될 것이다.

<br><br>

# 🐳 02.도커의 기초 - 도커 설치하기 🐳

## OS별 설치 방법

도커를 설치하는 방법은 윈도우,리눅스,macOS냐에 따라 달라진다.

사실 설치 방법에 대해서는 이미 블로그들에 많이 소개되어 링크를 첨부하도록 하겠다.

- [윈도우 도커 설치](https://goddaehee.tistory.com/251)

- [리눅스 도커 설치](https://medium.com/@elastic7327/%EB%A6%AC%EB%88%85%EC%8A%A4-%EC%9A%B0%EB%B6%84%ED%88%AC-centos-%EC%97%90-1%EB%B6%84%EB%A7%8C%EC%97%90-%EB%8F%84%EC%BB%A4%EB%A5%BC-%EC%84%A4%EC%B9%98%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95-how-to-install-a-docker-on-linux-ubuntu-centos-in-one-minute-d4fb1718e66d)

- [macOS 도커 설치](https://daeson.tistory.com/290)

<br><br><br>

**참고**

[도커/쿠버네티스를 활용한 컨테이너 개발 실전 입문](http://www.yes24.com/Product/Goods/70893433)

[초보를 위한 도커 안내서](https://subicura.com/2017/01/19/docker-guide-for-beginners-1.html)
